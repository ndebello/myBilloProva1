function VisiblePageViewController(e,t){this.html="",this.singleViewController={},this.leftViewController={},this.rightViewController={},this.epubData={},this.currentPage=0,this.epubData=SCHtmlController.currentWorksapceObj,this.currentPage=e,this.view=$("#container-content-"+e),this.leftViewElementClass="leftPageView",this.rightViewElementClass="rightPageView",this.singleViewElementClass="singlePageView";var i="container-content-"+e,n=t,a=SCHtmlController.isDoublePageInLandscape,o=SCHtmlController.currentWorksapceObj.isRTL,r=this.view.width(),s=this.view.height();if(a){var l=0,c=r/2+.1,h={},g={};h.x=l,h.y=0,h.width=SCGeneral.setNumDecimals(parseFloat(r/2)),h.height=s,g.x=c,g.y=0,g.width=SCGeneral.setNumDecimals(parseFloat(r/2)),g.height=s,this.view.append('<div class="'+SCHtmlController.containerWrapperEl+'"><div class="'+this.leftViewElementClass+'"></div><div class="'+this.rightViewElementClass+'"></div></div>'),$("#"+i+" ."+this.leftViewElementClass).css({left:h.x,top:h.y,width:h.width,height:h.height}),$("#"+i+" ."+this.rightViewElementClass).css({left:g.x,top:g.y,width:g.width,height:g.height});var u=SCHtmlController.getPageBookLeft(e),d=SCHtmlController.getPageBookRight(e);(u>0&&!o||u<=SCHtmlController.currentWorksapceObj.countPages&&o)&&(this.leftViewController=new PageViewController(u,n,!0,i,this.leftViewElementClass,h)),(d<=SCHtmlController.currentWorksapceObj.countPages&&!o||d>0&&o)&&(this.rightViewController=new PageViewController(d,n,!1,i,this.rightViewElementClass,g));var p=this;$(window).on("resize",function(){p.resizePageView()})}else{var w=0,m=0,f={};f.x=w,f.y=m,f.width=r,f.height=s,this.view.append('<div class="'+SCHtmlController.containerWrapperEl+'"><div class="'+this.singleViewElementClass+'"></div></div>'),$("#"+i+" ."+this.singleViewElementClass).css({left:f.x,top:f.y,width:f.width,height:f.height});var C=SCHtmlController.getPageBook(e),v=new PageViewController(C,n,!0,i,this.singleViewElementClass,f);this.singleViewController=v,n?v.isCurrentPage=!0:(v.isCurrentPage=!1,v.hideWebViewShowLoadingImage())}this.getSingleViewElementClass=function(){return"singleViewElementClass"}}function PageViewController(e,t,i,n,a,o){this.pageNumber=e,this.loadingImageView,this.didFinishLoad,this.currentXhtmlFile,this.timerHideImage,this.counterCLick,this.isCurrentPage=t,this.hasReadAloud,this.isPageLeft=i,this.pageXhtmlIsLoaded=!1,this.clickIsActive=!0,this.videoIsFullscreen,this.viewContainer="",this.iframeIdEl="",this.isPrevented=!1,this.waitShowingLoading=1e3;var r=e;this.pageString=r.toString();var s=SCHtmlDataController.SCPackagePath+"/"+SCHtmlDataController.infoUniqueId+"/"+SCHtmlController.currentWorkspace+"/"+SCHtmlDataController.OEBPSPath+"/"+SCHtmlDataController.AssetsPath+"/"+this.pageString+"/"+SCHtmlDataController.LoadingImageFile,l="#"+n+" ."+a;this.viewContainer=l,this.widthEl=o.width,this.heightEl=o.height,$(l).append('<div class="loadingImage" style="position: absolute; z-index: 2"><img src="'+s+'"></div>'),this.resizeLoadingImage(),this.initResizeLoadingImage()}function removePlaceHolderImage(){$("#content img#placeholder").hide("fast"),$("#content img#placeholder").remove()}var SCPackage={},SCPackageSmart={};jQuery.events=function(e){var t,i=[];return jQuery(e).each(function(){(t=jQuery._data(this,"events"))&&i.push({element:this,events:t})}),i.length>0?i:null};var SCGeneral={touchDownEvent:"",touchUpEvent:"",touchMoveEvent:"",pinchopen:"",pinchclose:"",browser:{ie:function(){return-1!==navigator.userAgent.indexOf("MSIE")||-1!==navigator.appVersion.indexOf("Trident/")?!0:void 0}(),ie8:function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=i.exec(t)&&(e=parseFloat(RegExp.$1))}return-1!=e&&9>e}(),ie10:window.navigator.pointerEnabled},support:{transforms3d:window.Modernizr&&Modernizr.csstransforms3d===!0||function(){var e=document.createElement("div").style;return"webkitPerspective"in e||"MozPerspective"in e||"OPerspective"in e||"MsPerspective"in e||"perspective"in e}(),touch:window.Modernizr&&Modernizr.touch===!0||function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}()},init:function(){this.setEvents()},isWindows:function(){return/windows/i.test(navigator.userAgent.toLowerCase())?!0:!1},SCPreventTouch:function(e){$(e).css("touch-action","none")},countProperties:function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&++t;return t},isTouch:function(){return"ontouchstart"in window},UrlExists:function(e){var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!=t.status},setNumDecimals:function(e){return Math.round(100*e)/100},setEvents:function(){this.support.touch?(this.touchDownEvent="touchstart",this.touchUpEvent="touchend",this.touchMoveEvent="touchmove",/android/i.test(navigator.userAgent.toLowerCase())?(this.pinchopen="pinchout",this.pinchclose="pinchin"):(this.pinchopen="pinchopen",this.pinchclose="pinchclose")):(this.touchDownEvent="mousedown",this.touchUpEvent="mouseup",this.touchMoveEvent="mousemove",this.pinchopen="dblclick",this.pinchclose="dblclick")},isMobileBrowser:function(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e},getNavigator:function(){return navigator.userAgent},isFullScreenEnabled:function(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled?!0:!1}},SCHtmlDataController={SCPackagePath:"BookPayload",OEBPSPath:"OEBPS",AssetsPath:"assets",METAINFPath:"META-INF",ContentOpfFileName:"content.opf",TocFileName:"toc.xhtml",UIdataFile:"pubcoder.xml",LoadingImageFile:"loading.jpg",ContentPageFile:"page.xhtml",smilFilePath:"audio/spe.mp3",infoUniqueId:"",bookId:"",infoAutoplay:!1,initDataCompleted:!1,initDesktopDataDone:!1,facingPagesInLandscape:!1,packageObject:SCPackage,initInfoTrigger:"initInfoCompleted",initDataCompletedTrigger:"initDataCompleted",initInfo:function(){this.getXmlAjax(this.SCPackagePath+"/info.xml",this.parseInfo)},initData:function(){this.getXmlAjax(this.SCPackagePath+"/workspaces-desktop.xml",this.parseSCPackage,"desktop");var e=this;$(document).on("initDesktopCompleted",function(t,i){e.packageObject=SCPackageSmart,e.getXmlAjax(e.SCPackagePath+"/workspaces-smartphone.xml",e.parseSCPackage,"smartphone")})},initContentOpf:function(){for(window.workspaceCounter=0,i=0;i<=this.packageObject.workspaces.length-1;i++){var e=SCHtmlDataController,t=e.SCPackagePath+"/"+e.infoUniqueId+"/"+e.packageObject.workspaces[i].path+"/"+e.OEBPSPath+"/"+e.ContentOpfFileName;e.getXmlAjax(t,e.parseContentOpf)}},initToc:function(){for(window.workspaceCounter=0,i=0;i<=this.packageObject.workspaces.length-1;i++){var e=SCHtmlDataController,t=e.SCPackagePath+"/"+e.infoUniqueId+"/"+e.packageObject.workspaces[i].path+"/"+e.OEBPSPath+"/"+e.TocFileName;e.getXmlAjax(t,e.parseToc)}},initUIdata:function(){for(window.workspaceCounter=0,i=0;i<=this.packageObject.workspaces.length-1;i++){var e=SCHtmlDataController,t=e.SCPackagePath+"/"+e.infoUniqueId+"/"+e.packageObject.workspaces[i].path+"/"+e.METAINFPath+"/"+e.UIdataFile;e.getXmlAjax(t,e.parseUIdata)}},initPagesData:function(){for(window.workspaceCounter=0,window.countSmilFiles=0,i=0;i<=this.packageObject.workspaces.length-1;i++){this.packageObject.workspaces[i].epub.pages=[],window.pages=0;var e=SCHtmlDataController,t=e.SCPackagePath+"/"+e.infoUniqueId+"/"+e.packageObject.workspaces[i].path+"/"+e.OEBPSPath+"/"+e.ContentOpfFileName;e.getXmlAjax(t,e.parsePagesData)}},initSmilData:function(){if(0==window.countSmilFiles)return this.callBackSet("smilDataDone");for(window.smilParsed=0,window.allSmil=[],i=0;i<=this.packageObject.workspaces.length-1;i++)for(j=0;j<=this.packageObject.workspaces[i].epub.pages.length-1;j++)if(this.packageObject.workspaces[i].epub.pages[j].readAloudExists){var e=SCHtmlDataController,t=e.SCPackagePath+"/"+e.infoUniqueId+"/"+e.packageObject.workspaces[i].path+"/"+e.OEBPSPath+"/"+e.packageObject.workspaces[i].epub.pages[j].smilPath;e.getXmlAjax(t,e.parseSmilData)}},parseInfo:function(e){var t=$(e).find("unique_build_id").text(),i=$(e).find("autoplay").text(),n=$(e).find("bookid").text(),a=$(e).find("facingPagesInLandscape").text(),o=SCHtmlDataController;o.infoUniqueId=t,o.infoAutoplay=i,o.bookId=n,o.facingPagesInLandscape=a,o.triggerInfoIsSet()},parseSCPackage:function(e){function t(e,t){var i=[];return $(e).find(t).each(function(){var e=this;$(this).find("properties").each(function(){var n={};if($(this).children().each(function(){var e=$(this)[0].nodeName,t=$(this).text();n[e]=t}),"SCTargetLocalization"==t){var a=$(e).attr("default"),o=!1;"true"==a&&(o=!0),n["default"]=o}i.push(n)})}),i}var n=t(e,"SCTargetDevice"),a=t(e,"SCTargetOrientation"),o=t(e,"SCTargetLocalization"),r=SCHtmlDataController;r.packageObject.formats=n,r.packageObject.orientations=a,r.packageObject.languages=o,r.packageObject.workspaces=[];var s={};for(i=0;i<=r.packageObject.formats.length-1;i++)for(j=0;j<=r.packageObject.orientations.length-1;j++)for(k=0;k<=r.packageObject.languages.length-1;k++){var l=r.packageObject.formats[i].id,c=r.packageObject.orientations[j].id,h=r.packageObject.languages[k].id,g=l+"."+c+"."+h;s.path=g,r.packageObject.workspaces.push({path:g})}var r=SCHtmlDataController;return r.callBackSet("SCPackageDone")},parseContentOpf:function(e){var t=SCHtmlDataController;t.packageObject.workspaces[window.workspaceCounter].epub={};var i=$(e).find("dc\\:title").text();""==i&&(i=$(e).find("title").text()),t.packageObject.workspaces[window.workspaceCounter].epub.title=i;var n=$(e).find("dc\\:creator").text();""==n&&(n=$(e).find("creator").text()),t.packageObject.workspaces[window.workspaceCounter].epub.author=n;var a=$(e).find("dc\\:publisher").text();""==a&&(a=$(e).find("publisher").text()),t.packageObject.workspaces[window.workspaceCounter].epub.publisher=a;var o=$(e).find("dc\\:rights").text();""==o&&(o=$(e).find("rights").text()),t.packageObject.workspaces[window.workspaceCounter].epub.copyright=o;var r=$(e).find('item[id="cover-image"]').attr("href");t.packageObject.workspaces[window.workspaceCounter].epub.coverImagePath=r;var s,l=$(e).find("spine").attr("page-progression-direction");s="ltr"==l?!1:!0,t.packageObject.workspaces[window.workspaceCounter].epub.isRTL=s;var c=$(e).find("itemref").length;return t.packageObject.workspaces[window.workspaceCounter].epub.countPages=c,t.packageObject.workspaces[window.workspaceCounter].epub.pageListWithSCPageId=[],window.workspaceCounter++,t.callBackSet("contentOpfDone")},parseToc:function(e){var t=SCHtmlDataController;t.packageObject.workspaces[window.workspaceCounter].epub.pageListFromToc=[];var i=$(e).find('nav[epub\\:type="page-list"]');$(i).find("a").each(function(){var e=$(this).text(),i=$(this).attr("href");t.packageObject.workspaces[window.workspaceCounter].epub.pageListFromToc.push({pageNumber:e,pageValue:i})}),t.packageObject.workspaces[window.workspaceCounter].epub.chapterListFromToc=[];var i=$(e).find('nav[epub\\:type="toc"]');return $(i).find("a").each(function(){var e=$(this).text(),i=$(this).attr("href");t.packageObject.workspaces[window.workspaceCounter].epub.chapterListFromToc.push({pageChapter:e,pageValue:i})}),window.workspaceCounter++,t.callBackSet("TocDone")},parseUIdata:function(e){var t=SCHtmlDataController,i=$(e).find("onTouchSystemUI").text(),n=!1;"true"==i&&(n=!0),t.packageObject.workspaces[window.workspaceCounter].epub.onTouchSystemUI=n;var a=$(e).find("enableSwipe").text(),o=!1;"true"==a&&(o=!0),t.packageObject.workspaces[window.workspaceCounter].epub.enableSwipe=o;var r=$(e).find("viewportHeight").text();t.packageObject.workspaces[window.workspaceCounter].epub.viewportHeight=r;var s=$(e).find("viewportWidth").text();t.packageObject.workspaces[window.workspaceCounter].epub.viewportWidth=s;var l=$(e).find("thumbnailHeight").text();t.packageObject.workspaces[window.workspaceCounter].epub.thumbnailHeight=l;var c=$(e).find("thumbnailWidth").text();t.packageObject.workspaces[window.workspaceCounter].epub.thumbnailWidth=c;var h=$(e).find("showNavigationArrows").text(),g=!1;"true"==h&&(g=!0),t.packageObject.workspaces[window.workspaceCounter].epub.showNavigationArrows=g;var u=$(e).find("storeLinkAppleAppStore").text();t.packageObject.workspaces[window.workspaceCounter].epub.storeLinkAppleAppStore=u;var d=$(e).find("storeLinkGooglePlay").text();t.packageObject.workspaces[window.workspaceCounter].epub.storeLinkGooglePlay=d;var p=$(e).find("storeLinkAppleiBooks").text();t.packageObject.workspaces[window.workspaceCounter].epub.storeLinkAppleiBooks=p;var w=$(e).find("storeLinkGooglePlayBooks").text();t.packageObject.workspaces[window.workspaceCounter].epub.storeLinkGooglePlayBooks=w;var m=$(e).find("storeLinkAppleiBooks").text();t.packageObject.workspaces[window.workspaceCounter].epub.ebookStoreLinkiBooks=m;var f=$(e).find("storeLinkAmazon").text();t.packageObject.workspaces[window.workspaceCounter].epub.ebookStoreLinkAmazon=f;var C=$(e).find("storeLinkKobo").text();t.packageObject.workspaces[window.workspaceCounter].epub.ebookStoreLinkKobo=C;var v=$(e).find("storeLinkBarnesAndNoble").text();t.packageObject.workspaces[window.workspaceCounter].epub.ebookStoreLinkBarnesAndNoble=v;var k=$(e).find("buttonBuyLabel").text();t.packageObject.workspaces[window.workspaceCounter].epub.buttonBuyLabel=k;var b=$(e).find("sharingOnSocialNetworks").text(),S=!1;"true"==b&&(S=!0),t.packageObject.workspaces[window.workspaceCounter].epub.sharingOnSocialNetworks=S;var P=$(e).find("embedCode").text(),I=!1;"true"==P&&(I=!0),t.packageObject.workspaces[window.workspaceCounter].epub.embedCode=I;var E=$(e).find("downloadSampleUrl").text();return t.packageObject.workspaces[window.workspaceCounter].epub.downloadSampleUrl=E,window.workspaceCounter++,t.callBackSet("UIDataDone")},parsePagesData:function(e){var t=SCHtmlDataController;window.countPages=1;var i=0;return $(e).find("itemref").each(function(){i++;var n={};n.bookPage=countPages,window.countPages++;var a=$(this).attr("idref"),o=$(e).find('item[id="'+a+'"]').attr("pageid");n.SCPageId=o;var r=$(e).find('item[id="'+a+'"]').attr("media-overlay");if(void 0!==r){n.readAloudExists=!0;var s=$(e).find('item[id="'+r+'"]').attr("href");n.smilPath=s;var l=t.AssetsPath+"/"+i+"/"+t.smilFilePath;n.smilAudioPath=l,window.countSmilFiles++}else n.readAloudExists=!1;t.packageObject.workspaces[window.workspaceCounter].epub.pages.push(n)}),window.workspaceCounter++,t.callBackSet("pagesDataDone")},parseSmilData:function(e){var t=this,i=[];$(e).find("par").each(function(){var e={},t=$(this).find("text").attr("src"),n=t.split("#"),a=n[1];e.currentIdDom=a;var o=$(this).find("audio").attr("clipBegin");e.currentClipBegin=o;var r=$(this).find("audio").attr("clipEnd");e.currentClipEnd=r,i.push(e)}),window.allSmil.push(i),window.smilParsed++;var t=SCHtmlDataController;return window.smilParsed==window.countSmilFiles?t.callBackSmil():void 0},getXmlAjax:function(e,t,i){var n=SCHtmlDataController;$.ajax({type:"GET",url:e,dataType:"xml",success:t,error:function(){"desktop"==i?n.triggerInitDesktopCompleted():"smartphone"==i?n.triggerInitSmartphoneCompleted():n.genericError(e)}})},genericError:function(e){alert("Unable to parse file: "+e)},callBackSet:function(e){var t=SCHtmlDataController;"SCPackageDone"==e?this.initContentOpf():"contentOpfDone"==e&&window.workspaceCounter==t.packageObject.workspaces.length?this.initToc():"TocDone"==e&&window.workspaceCounter==t.packageObject.workspaces.length?this.initUIdata():"UIDataDone"==e&&window.workspaceCounter==t.packageObject.workspaces.length?this.initPagesData():"pagesDataDone"==e&&window.workspaceCounter==t.packageObject.workspaces.length?this.initSmilData():"smilDataDone"==e&&(this.initDesktopDataDone?this.triggerInitDataCompleted():(this.triggerInitDesktopCompleted(),this.initDesktopDataDone=!0));sizeof(t.packageObject)},callBackSmil:function(){var e=SCHtmlDataController,t=0;for(i=0;i<=e.packageObject.workspaces.length-1;i++)for(j=0;j<=e.packageObject.workspaces[i].epub.pages.length-1;j++)e.packageObject.workspaces[i].epub.pages[j].readAloudExists&&(e.packageObject.workspaces[i].epub.pages[j].smil=window.allSmil[t],t++);this.callBackSet("smilDataDone")},checkIfDataIsEmpty:function(e){return $.isEmptyObject(e)?!0:!1},triggerInitDataCompleted:function(){setTimeout(function(){$(document).trigger("initDataCompleted",[!0])},1)},triggerInitDesktopCompleted:function(){setTimeout(function(){$(document).trigger("initDesktopCompleted",[!0])},1)},triggerInitSmartphoneCompleted:function(){this.triggerInitDataCompleted()},triggerInfoIsSet:function(){setTimeout(function(){$(document).trigger("initInfoCompleted",[!0])},1)},checkIfProjectIsUpdated:function(e){var t=!1;return this.infoUniqueId!=e&&(t=!0),t}},SCHtmlController={currentLocalStoragePackage:"",currentWorkspace:"",currentLanguageId:"",currentOrientation:"",currentFormatId:"",smilAudio:"",generalContainerEl:"SCcontainer",splashPageEl:"SCSplash",navigationBarEl:"SCNavbar",navigationBarId:"navbar",navigationBarLeftEl:"navbar-complete",infoEl:"SCInfo",chaptersEl:"SCChapters",readAloudButtonNavEl:"SCReadAloudButtonNav",readAoudIconImgEl:"SCReadAloudBtnImg",soundtrackButtonNavEl:"SCSoundtrackButtonNav",soundtrackIconImgEl:"SCSoundtrackBtnImg",fullScreenEl:"SCfullscreen",pageViewerLeftEl:"SCPageViewerLeft",pageViewerCenterEl:"SCPageViewerCenter",pageViewerRightEl:"SCPageViewerRight",swiperContainerEl:"swiper-container",containerWrapperEl:"container-wrapper",swiperSlideIdViewerEl:"viewer",outerEl:"Outer",middleEl:"Middle",containerContentEl:"container-content",navigationTocEl:"SCNavigationToc",navigationRightEl:"SCNavigationRight",navigationLeftEl:"SCNavigationLeft",navigationLanguagesDropDownIdEl:"SCLanguages",navigationArrowsEl:"SCNavigationArrows",thumbTocIdEl:"SCThumbBookPage",socialBarEl:"social-share-bar",readAloudButtonEl:"SCReadAloudButton",readAloudEl:"SCReadAloud",soundtrackDomElName:"SCSoundtrack",soundtrackButtonEl:"SCSoundtrackButton",soundtrackDomPath:"",thumbTocFileName:"thumbnail.jpg",pathNameInIframe:"content.html",pathNameFullScreen:"content.html",positionInViewerFirst:"first",positionInViewerMiddle:"middle",positionInViewerLast:"last",currentDomId:"",previousDomId:"",previousPageViewer:"",contRect:"",htmlRect:"",scrollLeft:"",scrollTop:"",nodeDeltaX:"",nodeDeltaY:"",iframeContent:"",maxBounceSwipe:100,previousPageViewerInt:0,currentSmilIndex:0,viewerPagesCount:0,swiperCountTouches:0,currentPageViewerInt:0,startingPageForViewInt:0,posLeftForMenuToc:0,pageViewerWidth:0,pageViewerHeight:0,thresholdCountTouchesForMenu:4,marginArrows:100,navigationTocElMarginBottom:7,speedSwiper:500,marginThumbnails:7,heightNavigationToc:0,transformRatio:1,iframeStartingOffsetLeft:0,iframeStartingOffsetTop:0,goToPageCanBeTriggered:!0,goToPageIsTriggered:!1,tocIsVisible:!1,isViewing:!1,hasReadAloud:!1,firstPageReadAloudHasFinished:!1,isDoublePageInLandscape:!1,readAloudIsPlaying:!1,readAloudIsActive:!1,readAloudFileIsVideo:!1,soundtrackIsPlaying:!1,soundtrackIsActive:!1,soundtrackWasCheched:!1,isTouchedInIframe:!1,swiperIsTouched:!1,timeoutHandleTriggerTouchStart:null,initPosClient:{},currentWorksapceObj:{},SCSwiper:{},currentPageView:{},leftPageView:{},rightPageView:{},viewControllers:[],smilArray:[],init:function(){this.isViewing||(this.setFormat(),this.setOrientation(),this.setIsDoublePageInLandscape(),this.setLanguageId(this.getInitialLanguage()),this.setCurrentWorkspace(this.getFormat(),this.getOrientationId(this.getOrientation()),this.getLanguage()),"true"==SCHtmlDataController.infoAutoplay?this.initUIEpub():(this.setEpubProperties(),this.setSplashPage()))},getCurrentData:function(){return 0==SCGeneral.isMobileBrowser()?SCPackage:SCPackageSmart},setSplashPage:function(){var e=this,t='<div id="'+this.splashPageEl+'"><div class="Outer"><div class="Middle"><a href="javascript:;"><img src="images/icon_play.svg" id="SCPlayBook" /></a></div></div></div>',i=SCHtmlDataController.SCPackagePath+"/"+SCHtmlDataController.infoUniqueId+"/"+this.getCurrentWorkspace()+"/"+SCHtmlDataController.OEBPSPath+"/"+this.currentWorksapceObj.coverImagePath;$("#"+this.generalContainerEl).append(t),$("#"+this.splashPageEl).css({"background-image":"url("+i+")","background-repeat":"no-repeat","background-position":"center center","background-attachment":"fixed","background-size":"cover"}),$("#"+this.splashPageEl+" a").bind(SCGeneral.touchDownEvent,function(t){t.preventDefault(),$("#"+e.splashPageEl).fadeOut(150,function(){$("#"+e.splashPageEl).remove(),e.initUIEpub()})})},initUIEpub:function(){this.setEpubProperties(),this.isViewing&&this.emptyUIViews(),this.setStartingPageForViewInt(),this.initUIViews(),this.setToc(),this.setParseToc(),this.setNavTitle(),this.isViewing||(this.initFullscreenIcon(),this.checkLanguageForIconModal(),this.initOrientationChange()),this.setParseLanguages(),this.setChapters(),this.setParseChapters(),this.isViewing||this.checkSoundtrackForIcon(),this.checkRAForIcon(),this.setInfo("Info"),this.initNavigationArrows(),this.activateNavigationArrows(),this.initToggleTocInIframe(),this.setPageDim(),this.setViewControllers(),this.updatePositionToc(this.currentPageViewerInt),this.highlightTocElement(),this.isViewing||(this.setSCSwipe(),this.setSwiperTransitionEnd(),this.initResize(),this.initWheelDetection(),this.initListenKeyArrows()),this.initShareButton(),this.initShareButtonOntouch(),this.initDownloadIcon(),this.initBookStores(),this.loadPagesAndUnloadPages(this.startingPageForViewInt),this.isViewing=!0},setEpubProperties:function(){this.setCurrentWorkspaceObj(),this.setPagesCountForViewer(this.currentWorksapceObj.countPages)},initUIViews:function(){this.setPageViewerDim(),this.setTransformRatio(),this.setPositionPageViewers(!0),this.setScrollView()},initOrientationChange:function(){var e=this;window.addEventListener("orientationchange",function(){var t;t="90"==window.orientation||"-90"==window.orientation?"landscape":"portrait",e.initNewLayout(t,!1,!0)},!1)},initFullscreenIcon:function(){var e=!1,t='<li id="'+this.fullScreenEl+'"><a href="#" role="button" aria-expanded="false"><img src="images/icon_enlarge.png"/></a></li>';self==top?($("#"+this.navigationBarEl+" ."+this.navigationBarLeftEl).prepend(t),e=!0):SCGeneral.isFullScreenEnabled()&&($("#"+this.navigationBarEl+" ."+this.navigationBarLeftEl).prepend(t),e=!0),e&&this.initToggleFullscreen()},initToggleFullscreen:function(){var e=this;window.stateFullScreen=!1,$("#"+this.navigationBarEl+" #"+this.fullScreenEl+" a").bind("click touchend",function(t){t.preventDefault(),e.closeToc(),window.stateFullScreen||"function"==typeof SCisFullScreen?e.exitFullscreen(SCGeneral.isFullScreenEnabled()):e.launchIntoFullscreen(SCGeneral.isFullScreenEnabled(),document.documentElement)}),document.documentElement.addEventListener("fullscreenchange",function(){window.stateFullScreen=document.FullScreen,e.changeFullScreenState()},!1),document.documentElement.addEventListener("mozfullscreenchange",function(){window.stateFullScreen=document.mozFullScreen,e.changeFullScreenState()},!1),document.documentElement.addEventListener("webkitfullscreenchange",function(){window.stateFullScreen=document.webkitIsFullScreen,e.changeFullScreenState()},!1)},changeFullScreenState:function(){window.stateFullScreen?$("#"+this.navigationBarEl+" #"+this.fullScreenEl+" img").attr("src","images/icon_minimize.png"):$("#"+this.navigationBarEl+" #"+this.fullScreenEl+" img").attr("src","images/icon_enlarge.png")},launchIntoFullscreen:function(e,t){e?t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen():window.open("index.html")},exitFullscreen:function(e){e?document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():window.close()},getFormat:function(){return this.currentFormatId},setFormat:function(){var e,t,i=$(window).width(),n=$(window).height();i>n?(e=i,t=n):(e=n,t=i);var a,o=window.SCPackageData.formats,r="";if(o.length>1){var s=parseFloat(e/t),l=[];for(a=0;a<o.length;a++){var c,h,g,u=o[a];c=u.screenWidth,h=u.screenHeight,g=u.id;var d=parseFloat(c/h),p=parseFloat(d-s),w=Math.abs(SCGeneral.setNumDecimals(p)),m=[c,h,g,w];l.push(m)}var f=l.sort(function(e,t){return e[3]-t[3]}),C=[];for(a=0;1>a;a++){var v=f[a],c=v[0],h=v[1];(h>=t||c>=e)&&C.push(v)}var k,b,S;if(C.length>0)for(k=0;k<C.length;k++){var v=C[k],c=v[0],P=v[2],p=v[3];if(0==k&&(r=P),k>0&&parseFloat(p)==S){var I=c-e;b>I&&(r=P)}S=parseFloat(p),b=c-e}else for(k=0;k<f.length;k++){var v=f[k],c=v[0],P=v[2],p=v[3];if(0==k&&(r=P),k>0){var I=e-c;b>I&&(r=P)}S=parseFloat(p),b=e-c}}else r=o[0].id;""==r&&console.log("Sorry, I couldn't find it"),this.currentFormatId=r},setOrientation:function(){var e,t=$(window).width(),i=$(window).height();e=t>i?"landscape":"portrait",this.currentOrientation=e},getOrientation:function(){return this.currentOrientation},getInitialLanguage:function(){var e,t=localStorage.getItem(SCHtmlDataController.bookId+"language");if(null==t){var i=navigator.language||navigator.userLanguage,n=i.substring(0,2);e=this.existsLanguageInWorkspace(n)?n:this.getDefaultLanguage(),localStorage.setItem(SCHtmlDataController.bookId+"language",e)}else e=t;return e},existsLanguageInWorkspace:function(e){var t=!1;return $.each(window.SCPackageData.languages,function(){this.languageCode==e&&(t=!0)}),t},getDefaultLanguage:function(){var e;return $.each(window.SCPackageData.languages,function(){this["default"]&&(e=this.languageCode)}),e},setCurrentWorkspace:function(e,t,i){var n,a=t;n=e+"."+a+"."+i,this.currentWorkspace=n},getCurrentWorkspace:function(){return this.currentWorkspace},setLanguageId:function(e){var t;$.each(window.SCPackageData.languages,function(){this.languageCode==e&&(t=this.id)}),this.currentLanguageId=t},getLanguage:function(){return this.currentLanguageId},getOrientationId:function(e){var t;return $.each(window.SCPackageData.orientations,function(){this.orientation==e&&(t=this.id)}),void 0==t&&$.each(window.SCPackageData.orientations,function(){t=this.id}),t},setIsDoublePageInLandscape:function(){"true"==SCHtmlDataController.facingPagesInLandscape&&"landscape"==this.getOrientation()?this.isDoublePageInLandscape=!0:this.isDoublePageInLandscape=!1},setCurrentWorkspaceObj:function(){var e=this;$.each(window.SCPackageData.workspaces,function(){this.path==e.currentWorkspace&&(e.currentWorksapceObj=this.epub)})},setPagesCountForViewer:function(e){this.isDoublePageInLandscape?e%2?this.viewerPagesCount=(e+1)/2:this.viewerPagesCount=e/2+1:this.viewerPagesCount=e},setStartingPageForViewInt:function(){this.isViewing?this.startingPageForViewInt=this.getPageForView(this.previousPageBookInt):this.currentWorksapceObj.isRTL?this.startingPageForViewInt=this.getPageForView(1):this.startingPageForViewInt=0,this.setCurrentPageViewerInt(this.startingPageForViewInt)},setPositionPageViewers:function(e){var t=this;e&&this.setPositionPageViewersFullScreen(),setTimeout(function(){t.setPositionPageViewersFullScreen()},1)},setPositionPageViewersFullScreen:function(e){$("#"+this.pageViewerRightEl).css("left","100%"),$("#"+this.pageViewerLeftEl).css("left","-100%")},setScrollView:function(){var e,t,n;for(this.getPositionInViewer()==this.positionInViewerFirst?(n=1,t=2):this.getPositionInViewer()==this.positionInViewerLast?(n=0,t=1):(n=0,t=2),i=n;i<=t;i++){var a,o,r,s;switch(i){case 0:a=this.swiperViewerLeft,o=this.positionInViewerLeft,r=this.currentPageViewerInt-1,s=this.pageViewerLeftEl;break;case 1:a=this.swiperViewerCenter,o=this.positionInViewerCenter,r=this.currentPageViewerInt,s=this.pageViewerCenterEl;break;case 2:a=this.swiperViewerRight,o=this.positionInViewerRight,r=this.currentPageViewerInt+1,s=this.pageViewerRightEl}e='<div class="'+this.outerEl+'"><div class="'+this.middleEl+'"><div class="'+this.containerContentEl+'" id="'+this.containerContentEl+"-"+r+'"></div></div></div>\n',$(e).appendTo("#"+s)}this.getPositionInViewer()==this.positionInViewerFirst?(s=this.pageViewerLeftEl,e='<div class="'+this.outerEl+'"><div class="'+this.middleEl+'"><div class="'+this.containerContentEl+'"></div></div></div>\n',$(e).appendTo("#"+s)):this.getPositionInViewer()==this.positionInViewerLast&&(s=this.pageViewerRightEl,e='<div class="'+this.outerEl+'"><div class="'+this.middleEl+'"><div class="'+this.containerContentEl+'"></div></div></div>\n',$(e).appendTo("#"+s))},updateViews:function(){this.goToPageIsTriggered=!1,this.goToPageCanBeTriggered=!0;var e,t;this.getPositionInViewer(this.getPreviousPageViewerInt());this.updateContentIdElements(),this.getCurrentPageViewerInt()>this.getPreviousPageViewerInt()?(e=this.getCurrentPageViewerInt()-1,t=this.getCurrentPageViewerInt()+1):(e=this.getCurrentPageViewerInt()+1,t=this.getCurrentPageViewerInt()-1),this.removePageViewer(e),this.viewControllers[this.getCurrentPageViewerInt()]&&this.viewControllers[this.getCurrentPageViewerInt()].hideWebViewShowLoadingImage(this.isDoublePageInLandscape),this.detachCenterEl(),this.pasteDetachElToSide(),this.copyDestElToCenterViewer(t);var i=this;setTimeout(function(){i.translateSwiper(!1,0),i.removePageViewer(t),i.loadPagesAndUnloadPages(i.getCurrentPageViewerInt())},10)},updateContentIdElements:function(){var e=this.getCurrentPageViewerInt()-1,t=this.getCurrentPageViewerInt()+1;$("#"+this.pageViewerLeftEl+" ."+this.containerContentEl).attr("id",this.containerContentEl+"-"+e),$("#"+this.pageViewerCenterEl+" ."+this.containerContentEl).attr("id",this.containerContentEl+"-"+this.getCurrentPageViewerInt()),$("#"+this.pageViewerRightEl+" ."+this.containerContentEl).attr("id",this.containerContentEl+"-"+t)},removePageViewer:function(e){$("#"+this.containerContentEl+"-"+e+" ."+this.containerWrapperEl).remove()},detachCenterEl:function(){this.detachedViewEl=$("#"+this.containerContentEl+"-"+this.getCurrentPageViewerInt()+" ."+this.containerWrapperEl),this.detachedViewEl.detach()},pasteDetachElToSide:function(){var e;this.getCurrentPageViewerInt();e=this.getPreviousPageViewerInt()<this.getCurrentPageViewerInt()?this.getCurrentPageViewerInt()-1:this.getCurrentPageViewerInt()+1,
this.detachedViewEl.appendTo("#container-content-"+e)},copyDestElToCenterViewer:function(e){var t=e,i=this.getCurrentPageViewerInt();$("#"+this.containerContentEl+"-"+t+" ."+this.containerWrapperEl).clone().appendTo("#container-content-"+i)},skipToPage:function(e){this.emptyScrollViews("."+this.containerWrapperEl),this.updateContentIdElements(),this.loadPagesAndUnloadPages(e),this.setPositionPageViewers(),this.updatePositionToc(this.getCurrentPageViewerInt()),this.highlightTocElement()},translateSwiper:function(e,t,i){var n,a,o,r=document.getElementById(this.pageViewerLeftEl).style,s=document.getElementById(this.pageViewerCenterEl).style,l=document.getElementById(this.pageViewerRightEl).style,c=$(window).width();e?i>this.getPreviousPageViewerInt()?(n=-1*c*2-1,a=-1*c-1,o=0,this.previousPageViewer=this.pageViewerRightEl):(n=0,a=c+1,o=2*c+1,this.previousPageViewer=this.pageViewerLeftEl):(n=-1*c,a=0,o=c+1),this.setTransitionDuration(r,t),this.setTranslate(r,a),this.setTransitionDuration(s,t),this.setTranslate(s,a),this.setTransitionDuration(l,t),this.setTranslate(l,a)},setTranslate:function(e,t){var i=SCGeneral.browser.ie?"translate("+t+"px, 0px)":"translate3d("+t+"px, 0px, 0px)";e.webkitTransform=e.MsTransform=e.msTransform=e.MozTransform=e.OTransform=e.transform=i},getTranslate:function(e,t){var i,n,a,o;return a=window.getComputedStyle(t,null),window.WebKitCSSMatrix?o=new WebKitCSSMatrix(a.webkitTransform):(o=a.MozTransform||a.OTransform||a.MsTransform||a.msTransform||a.transform||a.getPropertyValue("transform").replace("translate(","matrix(1, 0, 0, 1,"),i=o.toString().split(",")),n=window.WebKitCSSMatrix?o.m41:16==i.length?parseFloat(i[12]):parseFloat(i[4]),n||0},setTransitionDuration:function(e,t){e.webkitTransitionDuration=e.MsTransitionDuration=e.msTransitionDuration=e.MozTransitionDuration=e.OTransitionDuration=e.transitionDuration=t+"ms"},translateSwiperComplete:function(){this.updateViews(),this.setPositionPageViewers(),this.updatePositionToc(this.getCurrentPageViewerInt()),this.highlightTocElement()},wrapperTransitionEnd:function(e,t){function i(){if(e(a),!t)for(n=0;n<r.length;n++)a.h.removeEventListener(o,r[n],i)}var n,a=this,o=document.getElementById(a.pageViewerCenterEl),r=["webkitTransitionEnd","transitionend","oTransitionEnd","MSTransitionEnd","msTransitionEnd"];if(e)for(n=0;n<r.length;n++)a.h.addEventListener(o,r[n],i)},setSwiperCountTouches:function(e){this.swiperCountTouches=e},getSwiperCountTouches:function(){return this.swiperCountTouches},getThresholdCountTouchesForMenu:function(){return this.thresholdCountTouchesForMenu},setPageViewerDim:function(){this.isDoublePageInLandscape?(this.pageViewerWidth=SCGeneral.setNumDecimals(parseFloat(2*this.currentWorksapceObj.viewportWidth)),this.pageViewerHeight=SCGeneral.setNumDecimals(parseFloat(this.currentWorksapceObj.viewportHeight))):(this.pageViewerWidth=SCGeneral.setNumDecimals(parseFloat(this.currentWorksapceObj.viewportWidth)),this.pageViewerHeight=SCGeneral.setNumDecimals(parseFloat(this.currentWorksapceObj.viewportHeight)))},setPageDim:function(){var e=this.frameToFit(this.pageViewerWidth,this.pageViewerHeight,$(window).width(),$(window).height()),t=this.getTransformRatio(),i=this.pageViewerWidth,n=this.pageViewerHeight;i=e.width,n=e.height,$("."+this.containerContentEl).css({width:i,height:n});var a=parseInt(this.getHeightToc());this.heightNavigationToc=a;parseInt(this.currentWorksapceObj.thumbnailHeight*t),parseInt(this.currentWorksapceObj.thumbnailWidth*t);this.tocIsVisible&&$("#"+this.navigationTocEl+" .paginationContainer, #"+this.navigationTocEl+" .overflowContainer").height(a),SCGeneral.isWindows()&&$("#"+this.navigationTocEl).css("margin-bottom",this.navigationTocElMarginBottom+"px");var o=i+2*this.marginArrows*t;$("#"+this.navigationArrowsEl).css("max-width",o)},getHeightToc:function(){var e=230,t=64,i=$(window).height()/4;return i>e&&(i=e),t>i&&(i=e),i},setSwiper:function(){var e=this,t=!1;this.currentWorksapceObj.enableSwipe||(t=!0),this.isViewing?this.SCSwiper.reInit():this.SCSwiper=new Swiper("#"+this.generalContainerEl+" ."+this.swiperContainerEl,{mode:"horizontal",loop:!1,noSwiping:t,initialSlide:this.startingPageForViewInt,onTouchMove:function(){e.currentWorksapceObj.onTouchSystemUI&&window.clearTimeout(window.timeoutHandleTriggerTouchStart)}})},SCPreventTouch:function(e){$(e).css("touch-action","none")},setSCSwipe:function(){var e=$("#"+this.pageViewerCenterEl),t=document.getElementById(this.pageViewerCenterEl),i=this,n=this.h.addEventListener;n(t,SCGeneral.touchDownEvent,function(){i.onTouchDownForSwiper(event,e,t)}),this.currentWorksapceObj.enableSwipe&&n(t,SCGeneral.touchMoveEvent,function(){i.onTouchMoveForSwiper(event,e,t)}),n(t,SCGeneral.touchUpEvent,function(){i.onTouchUpForSwiper(event,e,t)})},onTouchDownForSwiper:function(e,t,i){e.preventDefault(),e.stopPropagation(),window.countTouchesInSwiper=0,this.setSwiperIsTouched(!0),this.setPreviousPageViewerInt(this.getCurrentPageViewerInt()),this.currentWorksapceObj.onTouchSystemUI&&this.toggleToc(),window.SCuaosIsWindows&&SCPreventTouch("#"+this.pageViewerCenterEl),e.stopPropagation();var n;$("."+this.swiperContainerEl);n="touchend"==SCGeneral.touchUpEvent?void 0!=e.originalEvent?e.originalEvent.changedTouches[0]:e.changedTouches[0]:e;var a=t[0].getBoundingClientRect();if(this.contRect=$("."+this.swiperContainerEl)[0].getBoundingClientRect(),this.htmlRect=$("html")[0].getBoundingClientRect(),this.scrollLeft=$("."+this.swiperContainerEl).scrollLeft(),this.scrollTop=$("."+this.swiperContainerEl).scrollTop(),this.getIsTouchedInIframe()){var o=$("#"+this.getIframeId()).offset();this.iframeStartingOffsetLeft=o.left,this.iframeStartingOffsetTop=o.top;var r=n.pageX+o.left-this.iframeStartingOffsetLeft}var s,l=this.getIsTouchedInIframe()?r:(n.clientX-this.htmlRect.left)/(this.htmlRect.right-this.htmlRect.left)*this.htmlRect.width;s={x:l},this.nodeDeltaX=s.x-a.left},onTouchMoveForSwiper:function(e,t,i){if(this.swiperIsTouched){window.countTouchesInSwipe++;var n=this.getSwiperCountTouches()+1;this.setSwiperCountTouches(n);var a;a="touchend"==SCGeneral.touchUpEvent?void 0!=e.originalEvent?e.originalEvent.changedTouches[0]:e.changedTouches[0]:e;$("#"+this.pageViewerLeftEl),$("#"+this.pageViewerCenterEl),$("#"+this.pageViewerRightEl);(this.getSwiperCountTouches()>this.getThresholdCountTouchesForMenu()&&SCGeneral.isWindows()||!SCGeneral.isWindows())&&(this.setSwiperCountTouches(0),window.clearTimeout(window.timeoutHandleTriggerTouchStart)),(SCGeneral.isWindows()&&5==window.countTouchesInSwipe||!SCGeneral.isWindows()&&1==window.countTouchesInSwipe)&&this.closeToc(),e.stopPropagation();var o;t[0].getBoundingClientRect();if(this.getIsTouchedInIframe())var r=$("#"+this.getIframeId()).offset(),s=a.pageX+r.left-this.iframeStartingOffsetLeft;var l=this.getIsTouchedInIframe()?s:(a.clientX-this.htmlRect.left)/(this.htmlRect.right-this.htmlRect.left)*this.htmlRect.width;o={x:l};var c=0-this.nodeDeltaX+this.scrollLeft-this.contRect.left+o.x,h=(c-$(window).width(),c+$(window).width(),document.getElementById(this.pageViewerLeftEl).style),g=document.getElementById(this.pageViewerCenterEl).style,u=document.getElementById(this.pageViewerRightEl).style,d=document.getElementById(this.pageViewerCenterEl);this.setTransitionDuration(h,0),this.setTranslate(h,c),this.setTransitionDuration(g,0),this.setTranslate(g,c),this.setTransitionDuration(u,0),this.setTranslate(u,c),(0==this.getCurrentPageViewerInt()&&this.getTranslate("x",d)>this.maxBounceSwipe||this.getCurrentPageViewerInt()==this.getViewerPagesCount()-1&&this.getTranslate("x",d)<-1*this.maxBounceSwipe)&&this.onTouchUpForSwiper(event,t,i)}},onTouchUpForSwiper:function(e,t,i){window.countTouchesInSwipe=0,this.setSwiperCountTouches(0),this.setSwiperIsTouched(!1),this.getIsTouchedInIframe()&&this.setIsTouchedInIframe(!1);var n=$(window).width(),a=$("#"+this.pageViewerCenterEl+" ."+this.containerWrapperEl).offset(),o=parseFloat(a.left-$(window).scrollLeft()),r=parseFloat($("#"+this.pageViewerCenterEl+" ."+this.containerWrapperEl).width()),s=this.getCurrentPageViewerInt()+1,l=this.getCurrentPageViewerInt()-1;parseFloat(t.css("left")),document.getElementById(this.pageViewerLeftEl).style,document.getElementById(this.pageViewerCenterEl),document.getElementById(this.pageViewerRightEl).style;n/2>o+r?this.goToPageViewer(s):o>n/2?this.goToPageViewer(l):this.translateSwiper(!1,this.speedSwiper)},setSwiperIsTouched:function(e){this.swiperIsTouched=e},setIframeId:function(e){this.iframeContent=e},getIframeId:function(){return this.iframeContent},setIsTouchedInIframe:function(e){this.isTouchedInIframe=e},getIsTouchedInIframe:function(){return this.isTouchedInIframe},setInitPosClient:function(e){this.initPosClient=e},getInitPosClient:function(){return this.initPosClient},initResize:function(){var e=this;$(window).on("resize",function(){e.setTransformRatio(),e.closeToc(),e.setPositionPageViewers(),e.setPageDim()})},initToggleToc:function(){if(this.currentWorksapceObj.onTouchSystemUI){var e=this;$("."+this.swiperContainerEl).bind(SCGeneral.touchDownEvent,function(){e.toggleToc()})}},initWheelDetection:function(){var e=this;this.currentWorksapceObj.showNavigationArrows&&document.addEventListener("mousewheel",function(t){0===t.wheelDeltaY&&(t.wheelDeltaX>800?e.goToPageCanBeTriggered&&e.goToPreviousPageViewer():t.wheelDeltaX<-800&&e.goToPageCanBeTriggered&&e.goToNextPageViewer())})},initListenKeyArrows:function(){if(this.currentWorksapceObj.showNavigationArrows){var e=this;$(document).keydown(function(t){e.goToPageAfterKeyPress(t)})}},goToPageAfterKeyPress:function(e){if(this.currentWorksapceObj.showNavigationArrows&&this.goToPageCanBeTriggered){var t=39,i=37;e.which==i?this.goToPreviousPageViewer():e.which==t&&this.goToNextPageViewer()}},setSwiperTransitionEnd:function(){var e=this;this.wrapperTransitionEnd(function(){e.getPreviousPageViewerInt()!=e.getCurrentPageViewerInt()&&(e.updateViews(),e.setPositionPageViewers(),e.updatePositionToc(e.getCurrentPageViewerInt()),e.highlightTocElement())},!0)},setViewControllers:function(){for(i=0;i<this.viewerPagesCount;i++)this.viewControllers.push(null)},setNavTitle:function(){$("#SCNavCenter #SCNavTitle").append(this.currentWorksapceObj.title)},checkLanguageForIconModal:function(){var e,t="";if(window.SCPackageData.languages.length>1){for(t+='<li class="dropdown" id="'+this.navigationLanguagesDropDownIdEl+'"><a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><img src="images/icon_flag.png" /></a>\n',t+='<ul class="dropdown-menu pull-right" role="menu">\n',i=0;i<window.SCPackageData.languages.length;i++)t+='<li id="SCLang'+window.SCPackageData.languages[i].id+'"><a href="switchToLang/'+window.SCPackageData.languages[i].id+'">'+window.SCPackageData.languages[i].label+"</a></li>\n";for(t+="</ul></li>",e='<div class="modal fade" id="SCLanguagesModal" tabindex="-1" role="dialog" aria-labelledby="SCLanguages" aria-hidden="true">',e+='<div class="modal-dialog">\n',e+='<div class="modal-content">\n',e+='<div class="modal-header">\n',e+='<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n',e+='<h4 class="modal-title">Languages</h4>\n',e+="</div>\n",e+='<div class="modal-body">\n',e+='<ul class="list-group">\n',i=0;i<window.SCPackageData.languages.length;i++)e+='<li class="list-group-item list-group-item"><span><a href="switchToLang/'+window.SCPackageData.languages[i].id+'" data-dismiss="modal">'+window.SCPackageData.languages[i].label+"</a></span></li>\n";e+="</ul>\n",e+="</div>\n",e+='<div class="modal-footer">\n',e+='<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n',e+="</div>\n",e+="</div><!-- /.modal-content -->\n",e+="</div><!-- /.modal-dialog -->\n",e+="</div><!-- /.modal -->",$("div#SCInfo").before(e),$("#"+this.navigationBarEl+" ."+this.navigationBarLeftEl).append(t)}},setParseLanguages:function(){for(i=0;i<window.SCPackageData.languages.length;i++)window.SCPackageData.languages[i].id==this.currentLanguageId?$("#"+this.navigationLanguagesDropDownIdEl+" li#SCLang"+window.SCPackageData.languages[i].id).addClass("active"):$("#"+this.navigationLanguagesDropDownIdEl+" li#SCLang"+window.SCPackageData.languages[i].id).removeClass("active");var e=this;$("#SCLanguages li a, #SCLanguagesModal a").bind("click",function(t){t.preventDefault();var i=$(this).attr("href"),n=e.getPageFromLink(i,1);n!=this.currentLanguageId&&e.initNewLayout(n,!0,!1)})},setChapters:function(){if(this.currentWorksapceObj.chapterListFromToc.length>1){var e='<li class="dropdown" id="'+this.chaptersEl+'">\n';e+='<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><img src="images/icon_chapters.png" /></a>\n',e+='<ul class="dropdown-menu pull-right" role="menu">\n',e+="</ul>\n",e+="</li>\n",$("#"+this.navigationBarEl+" ."+this.navigationBarLeftEl).append(e);for(var t=0;t<this.currentWorksapceObj.chapterListFromToc.length;t++){var i=this.currentWorksapceObj.chapterListFromToc[t];$("#"+this.navigationBarEl+" #"+this.chaptersEl+" .dropdown-menu ").append('<li data-scpage="'+i.pageChapter+'"><a href="'+i.pageValue+'">'+i.pageChapter+"</a></li>")}}},setParseChapters:function(){var e=this;$("#"+this.navigationBarEl+" #"+this.chaptersEl+" .dropdown-menu li a").bind("click",function(t){t.preventDefault();var i=$(this).attr("href"),n=e.getPageFromLink(i,1),a=e.getPageForView(n);e.goToPageViewer(a)})},readAloudExistsInWorkspace:function(){for(var e=!1,t=0;t<this.currentWorksapceObj.pages.length;t++)if(this.currentWorksapceObj.pages[t].readAloudExists){e=!0;break}return e?!0:!1},checkRAForIcon:function(){if(this.readAloudExistsInWorkspace()){var e='<li id="'+this.readAloudButtonNavEl+'"><a href="#" id="'+this.readAloudButtonEl+'"><img src="images/icon_readaloud.png" id="'+this.readAoudIconImgEl+'" /></a></li>\n';$("#"+this.navigationBarEl+" ."+this.navigationBarLeftEl).append(e),this.setParseRA()}},setParseRA:function(){var e=this;$("#"+this.navigationBarEl+" a#"+this.readAloudButtonEl).bind("click",function(t){var i=!1;e.isDoublePageInLandscape?(e.readAloudExists(e.getPageBookLeft(e.currentPageViewerInt))||e.readAloudExists(e.getPageBookRight(e.currentPageViewerInt)))&&(i=!0):e.readAloudExists(e.getPageBook(e.currentPageViewerInt))&&(i=!0),i&&e.toggleReadAloud()})},checkSoundtrackForIcon:function(){if(this.soundtrackExistsInWorkspace()){var e='<li id="'+this.soundtrackButtonNavEl+'"><a href="#" id="'+this.soundtrackButtonEl+'"><img src="images/icon_soundtrack.png" id="'+this.soundtrackIconImgEl+'" /></a></li>\n';$("#"+this.navigationBarEl+" ."+this.navigationBarLeftEl).append(e),this.setParseSoundtrack()}},setParseSoundtrack:function(){var e=this;$("#"+this.soundtrackButtonNavEl+" a#"+this.soundtrackButtonEl).bind("click",function(t){e.toggleSoundtrack()})},setInfo:function(e){var t=SCHtmlDataController.SCPackagePath+"/"+SCHtmlDataController.infoUniqueId+"/"+this.currentWorkspace+"/"+SCHtmlDataController.OEBPSPath+"/"+this.currentWorksapceObj.coverImagePath;$("#SC"+e+"Cover").append('<img src ="'+t+'" />'),$("#SC"+e+"Title").append(this.currentWorksapceObj.title),$("#SC"+e+"Author").append(this.currentWorksapceObj.author),$("#SC"+e+"Credits").append(this.currentWorksapceObj.copyright)},removeInfo:function(e){$("#SC"+e+"Cover").empty(),$("#SC"+e+"Title").empty(),$("#SC"+e+"Author").empty(),$("#SC"+e+"Credits").empty()},setToc:function(){var e,t,i,n="",a=SCHtmlDataController.SCPackagePath+"/"+SCHtmlDataController.infoUniqueId+"/"+this.currentWorkspace+"/"+SCHtmlDataController.OEBPSPath;for(t=1;t<=this.currentWorksapceObj.countPages;t++)i=this.currentWorksapceObj.isRTL?this.currentWorksapceObj.countPages+1-t:t,k=t-1,e='<li id="'+this.thumbTocIdEl+i+'"><a href="assets/'+i+'/page.xhtml" > <img src="'+a+"/assets/"+i+"/"+this.thumbTocFileName+'"/></a></li>\n',n+=e;$(n).appendTo("#"+this.navigationTocEl+" ul"),this.setHeightToc(0)},setParseToc:function(){var e=this;$("#"+this.navigationTocEl+" ul li a").bind("click",function(t){t.preventDefault();var i=$(this).attr("href"),n=e.getPageFromLink(i,1),a=e.getPageForView(n);e.goToPageViewer(a)})},unbind:function(e,t){$(e).unbind(t)},getBookStores:function(){var e={};return""!=this.currentWorksapceObj.storeLinkAppleAppStore&&(e.appstore=this.currentWorksapceObj.storeLinkAppleAppStore),""!=this.currentWorksapceObj.storeLinkGooglePlay&&(e.googleplay=this.currentWorksapceObj.storeLinkGooglePlay),""!=this.currentWorksapceObj.ebookStoreLinkiBooks&&(e.ibooks=this.currentWorksapceObj.ebookStoreLinkiBooks),""!=this.currentWorksapceObj.storeLinkGooglePlayBooks&&(e.googleplaybooks=this.currentWorksapceObj.storeLinkGooglePlayBooks),""!=this.currentWorksapceObj.ebookStoreLinkAmazon&&(e.amazon=this.currentWorksapceObj.ebookStoreLinkAmazon),""!=this.currentWorksapceObj.ebookStoreLinkKobo&&(e.kobo=this.currentWorksapceObj.ebookStoreLinkKobo),""!=this.currentWorksapceObj.ebookStoreLinkBarnesAndNoble&&(e.barnesnoble=this.currentWorksapceObj.ebookStoreLinkBarnesAndNoble),e},initBookStores:function(){var e=this.getBookStores(),t="",i=SCGeneral.countProperties(e);if(i>0){if(1==i){var n;n=""!=e.ibooks?e.ibooks:e.amazon?e.amazon:e.kobo?e.kobo:e.appstore?e.appstore:e.googleplay?e.googleplay:e.googleplaybooks?e.googleplaybooks:e.barnesnoble,t='<li id="SCBuyNow">\n<a href="'+n+'" type="button" role="button" aria-expanded="false" class="btn btn-primary navbar-btn" target="_blank">'+this.currentWorksapceObj.buttonBuyLabel+"</a>\n</li>"}else{t='<li id="SCBuyNow">\n<button type="button" data-toggle="modal" data-target="#SCBuyList" role="button" aria-expanded="false" class="btn btn-primary navbar-btn">'+this.currentWorksapceObj.buttonBuyLabel+"</button>\n";var a='<div class="modal fade" id="SCBuyList" tabindex="-1" role="dialog" aria-labelledby="Buy-List" aria-hidden="true">';a+='<div class="modal-dialog">\n',a+='<div class="modal-content">\n',a+='<div class="modal-header">\n',a+='<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n',a+='<h4 class="modal-title">Book Stores</h4>\n',a+="</div>\n",a+='<div class="modal-body">\n',a+='<ul class="list-group">\n',void 0!=e.appstore&&(a+='<li class="list-group-item list-group-item"><span><a href="'+e.appstore+'" target="_blank"><img src="images/icon_appstorebadge.png" /></a></span></li>\n'),void 0!=e.googleplay&&(a+='<li class="list-group-item list-group-item"><span><a href="'+e.googleplay+'" target="_blank"><img src="images/icon_googleplay.png" /></a></span></li>\n'),void 0!=e.ibooks&&(a+='<li class="list-group-item list-group-item"><span><a href="'+e.ibooks+'" target="_blank"><img src="images/icon_ibookstore.png" /></a></span></li>\n'),void 0!=e.googleplaybooks&&(a+='<li class="list-group-item list-group-item"><span><a href="'+e.googleplaybooks+'" target="_blank"><img src="images/icon_googleplaybooks.png" /></a></span></li>\n'),void 0!=e.amazon&&(a+='<li class="list-group-item list-group-item"><span><a href="'+e.amazon+'" target="_blank"><img src="images/icon_amazon.png" /></a></span> </li>\n'),void 0!=e.kobo&&(a+='<li class="list-group-item list-group-item"><span><a href="'+e.kobo+'" target="_blank"><img src="images/icon_kobo.png" /></a></span> </li>\n'),void 0!=e.barnesnoble&&(a+='<li class="list-group-item list-group-item"><span><a href="'+e.barnesnoble+'" target="_blank"><img src="images/icon_barnesnoble.png" /></a></span> </li>\n'),a+="</ul>\n",a+="</div>\n",a+='<div class="modal-footer">\n',a+='<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>\n',a+="</div>\n",a+="</div><!-- /.modal-content -->\n",a+="</div><!-- /.modal-dialog -->\n",a+="</div><!-- /.modal -->",$("div#SCInfo").before(a)}$("#"+this.navigationBarId+" ul."+this.navigationBarLeftEl).prepend(t)}},removeBookStores:function(){$("#SCBuyNow").remove(),$("#SCBuyList").remove()},initDownloadIcon:function(){if(""!=this.currentWorksapceObj.downloadSampleUrl){var e='<li id="SCdownload">\n';e+='<a href="#" data-toggle="modal" data-target="#SCDwonloadSample" role="button" aria-expanded="false" ><img src="images/icon_download.png" /></a>\n',e+="</li>";var t='<div class="modal fade" id="SCDwonloadSample" tabindex="-1" role="dialog" aria-labelledby="Sample" aria-hidden="true">\n';t+='  <div class="modal-dialog">\n',t+='    <div class="modal-content">\n',t+='      <div class="modal-header">\n',t+='        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n',t+='        <h4 class="modal-title" id="SCSampleLabel">Sample</h4>\n',t+="      </div>\n",t+='      <div class="modal-body">\n',t+='        <div id="SCSampleCover"></div>\n',t+='        <div id="SCSampleTitle"></div>\n',t+='        <div id="SCSampleAuthor"></div>\n',t+='        <div id="SCSampleCredits"></div>\n',t+='        <div id="SCDwonloadSampleButton"><a href="'+this.currentWorksapceObj.downloadSampleUrl+'" type="button" role="button" aria-expanded="false" class="btn btn-primary">Download Sample</a></div>\n',t+="      </div>\n",t+="    </div>\n",t+="  </div>\n",t+="</div>\n",$("#"+this.navigationBarId+" ul."+this.navigationBarLeftEl).prepend(e),$("div#SCInfo").before(t),this.setInfo("Sample")}},removeDownloadIcon:function(){$("#SCdownload").remove(),$("#SCDwonloadSample").remove()},removeChaptersIcon:function(){$("#"+this.chaptersEl).remove()},removeRAIcon:function(){$("#"+this.readAloudButtonNavEl).remove()},initShareButton:function(){if(this.currentWorksapceObj.embedCode||this.currentWorksapceObj.sharingOnSocialNetworks){var e='<li id="SCembed"><a href="#" role="button" aria-expanded="false" data-toggle="modal" data-target="#SCShareModal" ><img src="images/icon_share.png" /></a></li>';if($("#"+this.navigationBarId+" ul."+this.navigationBarLeftEl).prepend(e),this.currentWorksapceObj.embedCode){var t='      <div class="panel panel-info">\n';t+="        <div>&nbsp;</div>\n",t+='        <div class="panel-heading"><h3 class="panel-title">Copy the following code to embed it in your website:</h3></div>\n',t+='        <div class="panel-body">\n',t+='          <div class="input-group">\n',t+='          <span class="input-group-addon" id="basic-addon1">Html code</span>\n',t+='          <input type="text" class="form-control" placeholder="code" aria-describedby="basic-addon1" value=\'<iframe src="'+window.location.href+'" width="800" height="600" scrollbars="no"></iframe>\'>\n',t+="        </div>\n",t+="        </div>\n",t+="      </div>\n"}if(this.currentWorksapceObj.sharingOnSocialNetworks){var n=window.location.href,a=n.split("/"),o="";for(i=0;i<a.length-1;i++)o+=a[i]+"/";var r='<div class="socialbtn">\n';r+='    <li><a href="https://www.facebook.com/sharer/sharer.php?u='+o+'" title="share on facebook" class="share facebook"><img src="images/icon_bar_share_facebook.png" alt="share on facebook" id="icon_facebook" /></a></li>\n',r+='    <li><a href="https://twitter.com/intent/tweet?url='+o+'" title="share on twitter" class="share twitter"><img src="images/icon_bar_share_twitter.png" alt="share on twitter" id="icon_twitter" /></a></li>\n',r+='    <li><a href="http://www.linkedin.com/shareArticle?mini=true&url='+o+'" title="share on linkedin" class="share linkedin"><img src="images/icon_bar_share_linkedin.png" alt="share on linkedin" id="icon_linkedin"/></a></li>\n',r+='    <li><a href="https://plus.google.com/share?url='+o+'" title="share on googleplus" class="share googleplus"><img src="images/icon_bar_share_googleplus.png" alt="share on googleplus" id="icon_googleplus"/></a></li>\n',r+="  </ul>\n",r+="</div>\n"}var s='<div class="modal fade" id="SCShareModal" tabindex="-1" role="dialog" aria-labelledby="Buy-List" aria-hidden="true">\n';s+='<div class="modal-dialog">\n',s+='  <div class="modal-content">\n',s+='    <div class="modal-header">\n',s+='      <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n',s+='      <h4 class="modal-title">Share</h4>\n',s+="    </div>\n",s+='    <div class="modal-body">\n',this.currentWorksapceObj.embedCode&&this.currentWorksapceObj.sharingOnSocialNetworks?(s+='<div class="tabbable"> <!-- Only required for left/right tabs -->\n',s+='  <ul class="nav nav-tabs">\n',s+='    <li class="active"><a href="#tab1" data-toggle="tab">Social</a></li>\n',s+='    <li><a href="#tab2" data-toggle="tab">Embed</a></li>\n',s+="  </ul>\n",s+='  <div class="tab-content">\n',s+='    <div class="tab-pane active" id="tab1">\n',s+=r,s+="    </div>\n",s+='    <div class="tab-pane" id="tab2">\n',s+=t,s+="    </div>\n",s+="  </div>\n",s+="</div>\n"):this.currentWorksapceObj.embedCode&&!this.currentWorksapceObj.sharingOnSocialNetworks?s+=t:!this.currentWorksapceObj.embedCode&&this.currentWorksapceObj.sharingOnSocialNetworks&&(s+=r),s+="    </div>\n",s+="  </div><!-- /.modal-content -->\n",s+=" </div><!-- /.modal-dialog -->\n",s+="</div><!-- /.modal -->\n",$("div#SCInfo").before(s),this.currentWorksapceObj.sharingOnSocialNetworks&&this.preventShareButton()}},initShareButtonOntouch:function(){var e=window.location.href,t=e.split("/"),n="";for(i=0;i<t.length-1;i++)n+=t[i]+"/";var a=this;$("#icon_facebook").on("touchend",function(){a.goToLink("https://www.facebook.com/sharer/sharer.php?u="+n)}),$("#icon_twitter").on("touchend",function(){a.goToLink("https://twitter.com/intent/tweet?url="+n)}),$("#icon_linkedin").on("touchend",function(){a.goToLink("http://www.linkedin.com/shareArticle?mini=true&url="+n)}),$("#icon_googleplus").on("touchend",function(){a.goToLink("https://plus.google.com/share?url="+n)})},goToLink:function(e){window.open(e)},removeShareButton:function(){$("#SCembed").remove(),$("#SCShareModal").remove()},preventShareButton:function(){var e={Width:500,Height:500};$(".socialbtn a").bind(SCGeneral.touchDownEvent+" click",function(t){t.preventDefault();var i=Math.floor(((screen.availWidth||1024)-e.Width)/2),n=Math.floor(((screen.availHeight||700)-e.Height)/2),a=$(this).attr("href"),o=window.open(a,"social","width="+e.Width+",height="+e.Height+",left="+i+",top="+n+",location=0,menubar=0,toolbar=0,status=0,scrollbars=1,resizable=1");return o&&(o.focus(),t.preventDefault(),t.returnValue=!1),!!o})},setHeightToc:function(e){$("#"+this.navigationTocEl+" .paginationContainer, #"+this.navigationTocEl+" .overflowContainer, #"+this.navigationTocEl+" .SCpagination,  #"+this.navigationTocEl+" ul").height(e)},setPosLeftForMenuToc:function(e){this.posLeftForMenuToc=parseInt($("#"+this.navigationTocEl+" .SCpagination")[0].scrollWidth/this.viewerPagesCount*e);this.getPageBook(this.currentPageViewerInt)},updatePositionToc:function(e){var t=this.posLeftForMenuToc;$("#"+this.navigationTocEl+" .SCpagination").scrollLeft(t)},getPageFromLink:function(e,t){var i=e.split("/"),n=i[t];return n},initNavigationArrows:function(){this.currentWorksapceObj.showNavigationArrows&&$("#"+this.navigationArrowsEl).show()},hideNavigationArrows:function(){$("#"+this.navigationArrowsEl).hide()},showHideNavigationArrows:function(){this.currentWorksapceObj.showNavigationArrows&&(0==this.getCurrentPageViewerInt()?this.isRTL?(this.getViewerPagesCount()>1?$("#"+this.navigationLeftEl).show():$("#"+this.navigationLeftEl).hide(),$("#"+this.navigationRightEl).hide()):($("#"+this.navigationLeftEl).hide(),this.getViewerPagesCount()>1?$("#"+this.navigationRightEl).show():$("#"+this.navigationRightEl).hide()):this.getCurrentPageViewerInt()==this.getViewerPagesCount()-1?this.isRTL?($("#"+this.navigationLeftEl).hide(),this.getViewerPagesCount()>1?$("#"+this.navigationRightEl).show():$("#"+this.navigationRightEl).hide()):(this.getViewerPagesCount()>1?$("#"+this.navigationLeftEl).show():$("#"+this.navigationLeftEl).hide(),$("#"+this.navigationRightEl).hide()):($("#"+this.navigationLeftEl).show(),$("#"+this.navigationRightEl).show()))},goToPreviousPageViewer:function(){this.goToPageViewer(this.currentPageViewerInt-1)},goToNextPageViewer:function(){this.goToPageViewer(this.currentPageViewerInt+1)},goToPageViewer:function(e){e>-1&&e<this.viewerPagesCount&&(this.goToPageCanBeTriggered=!1,this.goToPageIsTriggered=!0,this.setPosLeftForMenuToc(e),e!=this.getCurrentPageViewerInt()&&(this.setPreviousPageViewerInt(this.getCurrentPageViewerInt()),this.setCurrentPageViewerInt(e),this.getCurrentPageViewerInt()==this.getPreviousPageViewerInt()+1||this.getCurrentPageViewerInt()==this.getPreviousPageViewerInt()-1?this.translateSwiper(!0,this.speedSwiper,e):(this.skipToPage(e),this.goToPageCanBeTriggered=!0))),this.closeToc()},emptyContents:function(){this.emptyScrollViews("."+this.outerEl),this.emptyViewControllers()},emptyViewControllers:function(){for(i=0;i<this.viewControllers.length;i++)this.viewControllers[i]=null},emptyUIViews:function(){this.emptyViewControllers(),$("."+this.swiperWrapperEl).empty(),$("#"+this.navigationTocEl+" ul").empty(),$("#"+this.navigationBarEl+" #SCChapters .dropdown-menu ").empty(),$("#"+this.navigationBarEl+" #SCNavTitle").empty(),this.removeShareButton(),this.removeDownloadIcon(),this.removeChaptersIcon(),this.removeRAIcon(),this.removeBookStores(),this.removeInfo("Info"),this.hideNavigationArrows(),this.emptyContents()},emptyScrollViews:function(e){$("#"+this.pageViewerLeftEl+" "+e).remove(),$("#"+this.pageViewerCenterEl+" "+e).remove(),$("#"+this.pageViewerRightEl+" "+e).remove()},activateNavigationArrows:function(){var e=!0;if(e){var t=this;$("#"+this.navigationLeftEl).bind(SCGeneral.touchDownEvent,function(e){t.goToPageCanBeTriggered&&t.goToPreviousPageViewer()}),$("#"+this.navigationRightEl).bind(SCGeneral.touchDownEvent,function(e){t.goToPageCanBeTriggered&&t.goToNextPageViewer()})}},frameToFit:function(e,t,i,n){var a,o,r={width:0,height:0};return e/t>i/n?(a=i,o=t*(i/e)):(o=n,a=e*(n/t)),r.width=a,r.height=o,r},setZoom:function(e){var t=SCGeneral.setNumDecimals(this.transformRatio);$(e).css({zoom:t,"-moz-transform":"scale("+t+", "+t+")","-moz-transform-origin":"0 0","-o-transform":"scale("+t+")","-o-transform-origin":"0 0","-webkit-transform":"scale("+t+")","-webkit-transform-origin":"50% 20%"})},setTransformRatio:function(){var e,t=this.pageViewerWidth,i=this.pageViewerHeight,n=$(window).width(),a=$(window).height();e=parseFloat(t/i)>parseFloat(n/a)?parseFloat(n/t):parseFloat(a/i),this.transformRatio=e},getTransformRatio:function(){return SCGeneral.setNumDecimals(this.transformRatio)},toggleToc:function(){var e=this;window.timeoutHandleTriggerTouchStart=window.setTimeout(function(){if(e.tocIsVisible)e.closeToc();else{e.openToc();"ontouchstart"in window||navigator.msMaxTouchPoints>0}},200)},openToc:function(){var e=this.heightNavigationToc,t=e;$("#"+this.navigationTocEl).height(e),this.setHeightToc(t),$("#"+this.navigationTocEl).hide().fadeIn(300),$("#"+this.navigationBarEl).fadeIn(300),$("."+this.socialBarEl).fadeIn(300),this.tocIsVisible=!0},closeToc:function(){var e=0,t=this;$("#"+this.navigationTocEl).fadeOut(300,function(){$("#"+this.navigationTocEl).height(e),$(this).css({display:"none"}),t.setHeightToc(0)}),$("#"+this.navigationBarEl).fadeOut(300),$("."+this.socialBarEl).fadeOut(300),this.tocIsVisible=!1},highlightTocElement:function(){if(this.isDoublePageInLandscape){var e=this.getPageBookLeft(this.currentPageViewerInt),t=this.getPageBookRight(this.currentPageViewerInt),i=this;$("#"+this.navigationTocEl+" li").each(function(){$(this).attr("id")==""+i.thumbTocIdEl+e||$(this).attr("id")==""+i.thumbTocIdEl+t?$(this).addClass("selected"):$(this).removeClass("selected")})}else{var i=this,n=this.getPageBook(this.currentPageViewerInt);$("#"+this.navigationTocEl+" li").each(function(){$(this).attr("id")==""+i.thumbTocIdEl+n?$(this).addClass("selected"):$(this).removeClass("selected")})}},initToggleTocInIframe:function(){},getPageForView:function(e){var t;return t=this.isDoublePageInLandscape?this.currentWorksapceObj.isRTL?e%2?(this.currentWorksapceObj.countPages-e+1)/2:(this.currentWorksapceObj.countPages-e)/2:e%2?(e-1)/2:e/2:this.currentWorksapceObj.isRTL?this.currentWorksapceObj.countPages-e:e-1;
},getPageFromBookForIndex:function(e){return e-1},loadPagesAndUnloadPages:function(e){this.loadScrollViewWithPage(e-1,!1),this.loadScrollViewWithPage(e,!0),this.loadScrollViewWithPage(e+1,!1)},loadScrollViewWithPage:function(e,t){if(!(e>this.viewerPagesCount-1||0>e)){this.readAloudFileIsVideo=!1;var i=e,n=this.viewControllers[e];if((null==n||0==$("#"+this.containerContentEl+"-"+e).children().length)&&(n=new VisiblePageViewController(i,t),this.viewControllers[i]=n),n.setIsCurrentPage(t,this.isDoublePageInLandscape),t){this.showHideNavigationArrows();var a=!1;this.readAloudIsPlaying&&this.stopReadAloud(),this.removeSmilAudioEl(),this.setSoundtrackWasChecked(!1),this.isDoublePageInLandscape?(this.leftPageView=n.getLeftPageView(),this.rightPageView=n.getRightPageView(),this.readAloudExists(this.getPageBookLeft(e))||this.readAloudExists(this.getPageBookRight(e))?(this.hasReadAloud=!0,this.readAloudIconSetEnabled()):(this.hasReadAloud=!1,this.readAloudIconSetDisabled())):(this.currentPageView=n.getCurrentPageView(),this.readAloudExists(this.getPageBook(e))?(this.hasReadAloud=!0,this.readAloudIconSetEnabled()):(this.hasReadAloud=!1,this.readAloudIconSetDisabled())),a&&this.readAloudIsPlaying&&this.playStopReadAloud("play"),this.currentPageViewerInt=e,this.currentPageBookInt=this.getPageBook(e),this.previousPageInt=this.currentPageViewerInt,this.readAloudIsPlaying=!1,this.currentSmilIndex=0,console.log(this.swiperIsTouched),n.showWebView(this.isDoublePageInLandscape)}else n.cleanWebView(),this.readAloudIsPlaying&&(this.playStopReadAloud(),this.readAloudIsPlaying=!1,this.readAloudIsActive=!0),n.hideWebViewShowLoadingImage(this.isDoublePageInLandscape)}},unloadScrollViewWithPage:function(e){$("#"+this.containerContentEl+e).empty(),this.viewControllers[e]=null},getPageBook:function(e){var t;return t=this.isDoublePageInLandscape?this.currentWorksapceObj.isRTL?this.currentWorksapceObj.countPages%2?this.currentWorksapceObj.countPages-1-2*e:this.currentWorksapceObj.countPages-2*e+1:0==e?1:2*e:this.currentWorksapceObj.isRTL?this.currentWorksapceObj.countPages-e:e+1},getPageBookLeft:function(e){var t;return t=this.currentWorksapceObj.isRTL?this.currentWorksapceObj.countPages%2?this.currentWorksapceObj.countPages-2*e:this.currentWorksapceObj.countPages+1-2*e:2*e},getPageBookRight:function(e){var t;return t=this.currentWorksapceObj.isRTL?this.currentWorksapceObj.countPages%2?this.currentWorksapceObj.countPages-1-2*e:this.currentWorksapceObj.countPages-2*e:2*e+1},getNewPageFromNewWorkspaceAndSetPreviousPageBookInt:function(e,t){var i=this.getCurrentPageInNewWorkspace(t,e);return this.previousPageBookInt=i,i},getCurrentPageInNewWorkspace:function(e,t){var i,n,a;for(n=0;n<this.currentWorksapceObj.pages.length;n++){var o=this.currentWorksapceObj.pages[n];o.bookPage==this.currentPageBookInt&&(a=o.SCPageId)}var r,s;for(r=0;r<window.SCPackageData.workspaces.length;r++){var l=window.SCPackageData.workspaces[r];t==l.path&&(s=l)}for(newPageBookExists=!1,n=0;n<s.epub.pages.length;n++){var c=s.epub.pages[n];c.SCPageId==a&&(i=c.bookPage,newPageBookExists=!0)}if(!newPageBookExists){var h=s.epub.pages[0];i=h.bookPage}return i},getWorkspaceString:function(e,t,i){var n;return void 0!=t?(n=e+"."+t+"."+i,this.isDoublePageInLandscape=!1):(n=e+"."+this.getOrientationId("portrait")+"."+i,this.isDoublePageInLandscape=!0),n},initNewLayout:function(e,t,i){this.closeToc();var n,a,o=this.getFormat();t?(a=e,n=this.getOrientationId(this.getOrientation())):(a=this.getLanguage(),n=this.getOrientationId(e));var r,s=this.getWorkspaceString(o,n,a);$.each(window.SCPackageData.workspaces,function(){this.path==s&&(r=this.epub)});var l=this.getNewPageFromNewWorkspaceAndSetPreviousPageBookInt(s,r);l=0,this.updateLayout(e,t,i)},updateLayout:function(e,t,i){this.unbind("#"+this.navigationBarEl+" #"+this.chaptersEl+" .dropdown-menu li a","click"),this.unbind("#SCLanguages li a, #SCLanguagesModal a","click"),this.unbind("#"+this.navigationBarEl+" a#"+this.readAloudButtonEl,"click"),this.unbind("#"+this.navigationBarEl+" a#"+this.soundtrackButtonEl,"click"),this.unbind("#"+this.navigationTocEl+" ul li a","click"),this.unbind("#"+this.navigationTocEl+" ul li a","click"),this.unbind("#"+this.navigationLeftEl,SCGeneral.touchDownEvent),this.unbind("#"+this.navigationRightEl,SCGeneral.touchDownEvent);var n,a,o=this.getFormat();t?(a=e,this.currentLanguageId=a,n=this.getOrientationId(this.getOrientation())):(a=this.getLanguage(),n=this.getOrientationId(e),this.currentOrientation=n),this.setCurrentWorkspace(o,n,a),this.initUIEpub()},toggleReadAloud:function(){this.playStopReadAloud(),this.readAloudIsPlaying||this.readAloudIconSetInActive(),this.closeToc()},playStopReadAloud:function(){var e=this.getPageToSync();this.readAloudIsPlaying?(this.stopReadAloud(),this.readAloudIsActive=!1,this.firstPageReadAloudHasFinished=!1,this.cleanWebviewsFromReadAloudClasses()):this.playAndSyncReadAloud(e)},getPageToSync:function(){var e;return this.isDoublePageInLandscape?this.currentWorksapceObj.isRTL?(e=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(this.getPageBookRight(this.getCurrentPageViewerInt()))],e.readAloudExists||(e=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(this.getPageBookLeft(this.getCurrentPageViewerInt()))])):(e=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(this.getPageBookLeft(this.getCurrentPageViewerInt()))],e.readAloudExists||(e=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(this.getPageBookRight(this.getCurrentPageViewerInt()))])):e=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(this.getPageBook(this.getCurrentPageViewerInt()))],e},playAndSyncReadAloud:function(e){this.setSmilValues(e),this.playReadAloud(),this.syncTextWithAudio(),self.readAloudIsActive=!0},setSmilValues:function(e){var t=SCHtmlDataController.SCPackagePath+"/"+SCHtmlDataController.infoUniqueId+"/"+this.currentWorkspace+"/"+SCHtmlDataController.OEBPSPath+"/"+e.smilAudioPath,i='<audio id="'+this.readAloudEl+'"><source src="'+t+'"></audio>';this.smilAudio=i,this.setDomEl("#"+this.generalContainerEl,this.smilAudio),this.smilArray=e.smil},playStopAudio:function(e){var t=$("audio#"+this.readAloudEl)[0];"play"==e?(t.play(),this.readAloudIconSetActive()):t.pause()},playReadAloud:function(){this.playStopAudio("play"),this.readAloudIsPlaying=!0},stopReadAloud:function(){this.playStopAudio("stop"),this.stopTimer(),this.smilAudio.currentTime=0,this.readAloudIsPlaying=!1},setDomEl:function(e,t){$(e).append(t)},removeSmilAudioEl:function(){$("#"+this.readAloudEl).remove()},syncTextWithAudio:function(){window.checkReadAould=window.setInterval("SCHtmlController.checkReadAloudAtTime()",5)},checkReadAloudAtTime:function(e){var t,i,n,a,o,r,s,l,c=$("audio#"+this.readAloudEl)[0];if(this.isDoublePageInLandscape)if(this.firstPageReadAloudHasFinished)l=this.currentWorksapceObj.isRTL?this.leftPageView:this.rightPageView;else if(this.currentWorksapceObj.isRTL){var h=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(this.getPageBookRight(this.getCurrentPageViewerInt()))];l=h.readAloudExists?this.rightPageView:this.leftPageView}else{var g=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(this.getPageBookLeft(this.getCurrentPageViewerInt()))];l=g.readAloudExists?this.leftPageView:this.rightPageView}else l=this.currentPageView;for(t=this.currentSmilIndex;t<this.smilArray.length;t++){var u=this.smilArray[t];if(a=u.currentIdDom,i=u.currentClipBegin,n=u.currentClipEnd,o=this.getInterval(i),r=this.getInterval(n),s=c.currentTime,s>o&&r>s&&a!=this.currentDomId)return this.previousDomId&&this.removeHighlightTextInWebView(this.previousDomId,l),this.highlightTextInWebView(a,l),this.currentDomId=a,void(this.previousDomId=this.currentDomId);if(s>r&&a==this.currentDomId)return this.removeHighlightTextInWebView(a,l),void(this.currentDomId="")}s>r&&(window.clearInterval(window.checkReadAould),this.readAloudIsFinished()),this.currentDomId="",this.currentSmilIndex=0},readAloudIsFinished:function(){this.cleanWebviewsFromReadAloudClasses(),this.isDoublePageInLandscape&&(this.firstPageReadAloudHasFinished||(this.firstPageReadAloudHasFinished=!0,this.playSecondPageReadAloud()))},playSecondPageReadAloud:function(){this.removeSmilAudioEl();var e,t;this.currentWorksapceObj.isRTL?this.getPageBookLeft(this.currentPageViewerInt)<this.currentWorksapceObj.countPages&&this.getPageBookLeft(this.currentPageViewerInt)>0&&(e=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(this.getPageBookLeft(self.currentPageViewerInt))],t=e.readAloudExists):this.getPageBookRight(this.currentPageViewerInt)<=this.currentWorksapceObj.countPages&&this.getPageBookRight(this.currentPageViewerInt)>0&&(e=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(this.getPageBookRight(this.currentPageViewerInt))],t=e.readAloudExists),e.readAloudExists&&this.playAndSyncReadAloud(e)},highlightTextInWebView:function(e,t){var i=$(t.viewContainer+" .pageContent iframe"),n=i.contents().find("#"+e);n.addClass("-epub-media-overlay-active")},removeHighlightTextInWebView:function(e,t){var i=$(t.viewContainer+" .pageContent iframe"),n=i.contents().find("#"+e);n.removeClass("-epub-media-overlay-active")},readAloudExists:function(e){var t=!1;if(e>0&&e<=this.currentWorksapceObj.countPages){var i=this.currentWorksapceObj.pages[this.getIndexObjectForPageArray(e)];t=i.readAloudExists?!0:!1}return t},getInterval:function(e){var t=e.split(":"),i=t[1],n=t[2],a=60*parseInt(i),o=a+n;return o},readAloudIconSetDisabled:function(){$("#"+this.readAloudButtonNavEl).removeClass("enabled").addClass("disabled")},readAloudIconSetEnabled:function(){$("#"+this.readAloudButtonNavEl).removeClass("disabled").addClass("enabled")},readAloudIconSetActive:function(){$("#"+this.readAoudIconImgEl).attr("src","images/icon_readaloud_active.png")},readAloudIconSetInActive:function(){$("#"+this.readAoudIconImgEl).attr("src","images/icon_readaloud.png")},stopTimer:function(){window.clearInterval(window.checkReadAould)},soundtrackExistsInWorkspace:function(){return!0},soundtrackExists:function(){var e=!1;return this.currentWorksapceObj.isDoublePageInLandscape?(e=this.soundtrackEl(this.leftPageView).length>0?!0:!1,e=this.soundtrackEl(this.rightPageView).length>0?!0:!1):e=this.soundtrackEl(this.currentPageView).length>0?!0:!1,e},soundtrackEl:function(e){var t=$(e.viewContainer+" .pageContent iframe"),i=t.contents().find('audio[epub\\:type="ibooks:soundtrack"]');return i},getSoundtrackAudio:function(){return this.currentWorksapceObj.isDoublePageInLandscape?this.soundtrackEl(this.leftPageView).length>0?this.soundtrackEl(this.leftPageView):this.soundtrackEl(this.rightPageView):this.soundtrackEl(this.currentPageView)},soundtrackIconSetDisabled:function(){$("#"+this.soundtrackButtonNavEl).removeClass("enabled").addClass("disabled")},soundtrackIconSetEnabled:function(){$("#"+this.soundtrackButtonNavEl).removeClass("disabled").addClass("enabled")},soundtrackIconSetActive:function(){$("#"+this.soundtrackIconImgEl).attr("src","images/icon_soundtrack_active.png")},soundtrackIconSetInActive:function(){$("#"+this.soundtrackIconImgEl).attr("src","images/icon_soundtrack.png")},toggleSoundtrack:function(){this.getSoundtrackIsPlaying()?(this.stopSoundtrack(),this.setSoundtrackIsActive(!1),this.soundtrackIconSetInActive()):this.soundtrackExists()&&(this.startSoundtrack(),this.setSoundtrackIsActive(!0),this.soundtrackIconSetActive()),this.closeToc()},stopSoundtrack:function(){this.startStopSoundtrack("stop")},startSoundtrack:function(){this.startStopSoundtrack("start")},startStopSoundtrack:function(e){"stop"==e?(this.setSoundtrackIsPlaying(!1),$("#"+this.soundtrackDomElName)[0].pause()):(this.setSoundtrackIsPlaying(!0),$("#"+this.soundtrackDomElName)[0].play())},getSoundtrackIsPlaying:function(){return this.soundtrackIsPlaying},setSoundtrackIsPlaying:function(e){this.soundtrackIsPlaying=e},getSoundtrackIsActive:function(){return this.soundtrackIsActive},setSoundtrackIsActive:function(e){this.soundtrackIsActive=e},getSoundtrackWasChecked:function(){return this.soundtrackWasChecked},setSoundtrackWasChecked:function(e){this.soundtrackWasChecked=e},setSoundtrackDomPath:function(e){this.soundtrackDomPath=e},getSoundtrackDomPath:function(){return this.soundtrackDomPath},getAbsolutePathFromSoundtrack:function(){var e=this.getSoundtrackAudio().attr("src"),t=e.split("/"),n="";for(i=1;i<t.length;i++)n+="/"+t[i];var a=SCHtmlDataController.SCPackagePath+"/"+SCHtmlDataController.infoUniqueId+"/"+this.currentWorkspace+"/"+SCHtmlDataController.OEBPSPath+"/"+SCHtmlDataController.AssetsPath+n;return a},getIndexObjectForPageArray:function(e){var t=e-1;return t},getCurrentPageViewerInt:function(){return this.currentPageViewerInt},setCurrentPageViewerInt:function(e){this.currentPageViewerInt=e},getPreviousPageViewerInt:function(){return this.previousPageViewerInt},setPreviousPageViewerInt:function(e){this.previousPageViewerInt=e},getViewerPagesCount:function(){return this.viewerPagesCount},getPositionInViewer:function(){var e;return e=this.getCurrentPageViewerInt()==this.getViewerPagesCount()-1?this.positionInViewerLast:0==this.getCurrentPageViewerInt()?this.positionInViewerFirst:this.positionInViewerMiddle},cleanWebviewsFromReadAloudClasses:function(){var e=$(".pageContent iframe"),t=e.contents().find("span");t.removeClass("-epub-media-overlay-active")},getEvents:function(e,t){var i=$(t),n=$("#"+e)[0].contentWindow.$,a=n._data($($("#singlePage").contents().find(i))[0],"events");return a},h:{addEventListener:function(e,t,i,n){"undefined"==typeof n&&(n=!1),e.addEventListener?e.addEventListener(t,i,n):e.attachEvent&&e.attachEvent("on"+t,i)},removeEventListener:function(e,t,i,n){"undefined"==typeof n&&(n=!1),e.removeEventListener?e.removeEventListener(t,i,n):e.detachEvent&&e.detachEvent("on"+t,i)}}};VisiblePageViewController.prototype.getCurrentPageView=function(){return this.singleViewController},VisiblePageViewController.prototype.getLeftPageView=function(){return this.leftViewController},VisiblePageViewController.prototype.getRightPageView=function(){return this.rightViewController},VisiblePageViewController.prototype.showWebView=function(e){e?("function"==typeof this.leftViewController.showWebViewHideLoadingImage&&this.leftViewController.showWebViewHideLoadingImage(),"function"==typeof this.rightViewController.showWebViewHideLoadingImage&&this.rightViewController.showWebViewHideLoadingImage()):this.singleViewController.showWebViewHideLoadingImage()},VisiblePageViewController.prototype.cleanWebView=function(){SCHtmlController.isDoublePageInLandscape?("function"==typeof this.leftViewController.cleanWebView&&this.leftViewController.cleanWebView(),"function"==typeof this.rightViewController.cleanWebView&&this.rightViewController.cleanWebView()):this.singleViewController.cleanWebView()},VisiblePageViewController.prototype.setIsCurrentPage=function(e,t){t?(this.leftViewController.isCurrentPage=e,this.rightViewController.isCurrentPage=e):this.singleViewController.isCurrentPage=e},VisiblePageViewController.prototype.hideWebViewShowLoadingImage=function(e){e?("function"==typeof this.leftViewController.hideWebViewShowLoadingImage&&this.leftViewController.hideWebViewShowLoadingImage(),"function"==typeof this.rightViewController.hideWebViewShowLoadingImage&&this.rightViewController.hideWebViewShowLoadingImage()):this.singleViewController.hideWebViewShowLoadingImage()},VisiblePageViewController.prototype.resizePageView=function(){var e=SCHtmlController.getTransformRatio(),t=parseInt(SCHtmlController.pageViewerWidth/2*e),i=parseInt(SCHtmlController.pageViewerHeight*e);$("."+this.leftViewElementClass).css({width:t,height:i}),$("."+this.rightViewElementClass).css({left:t,width:t,height:i})},PageViewController.prototype.initResizeLoadingImage=function(){var e=this;$(window).on("resize",function(){e.resizeLoadingImage()})},PageViewController.prototype.initResizeWebView=function(){var e=this;$(window).on("resize",function(){e.resizeWebView()})},PageViewController.prototype.resizeLoadingImage=function(){var e=SCHtmlController.transformRatio;SCGeneral.browser.ie?$(this.viewContainer+" .loadingImage").css("zoom",e):$(this.viewContainer+" .loadingImage").css({"-moz-transform":"scale("+e+", "+e+")","-moz-transform-origin":"0 0","-o-transform":"scale("+e+")","-o-transform-origin":"0 0","-webkit-transform":"scale("+e+")","-webkit-transform-origin":"0 0"})},PageViewController.prototype.resizeWebView=function(){var e=SCHtmlController.transformRatio;SCGeneral.browser.ie?$(this.viewContainer+" .pageContent iframe").css("zoom",e):$(this.viewContainer+" .pageContent iframe").css({"-moz-transform":"scale("+e+", "+e+")","-moz-transform-origin":"0 0","-o-transform":"scale("+e+")","-o-transform-origin":"0 0","-webkit-transform":"scale("+e+")","-webkit-transform-origin":"0 0"})},PageViewController.prototype.showWebViewHideLoadingImage=function(){window.webviewIsShown=!1,setTimeout(function(){window.webviewIsShown||$(".SCLoader").show()},this.waitShowingLoading);var e=SCHtmlDataController.SCPackagePath+"/"+SCHtmlDataController.infoUniqueId+"/"+SCHtmlController.currentWorkspace+"/"+SCHtmlDataController.OEBPSPath+"/"+SCHtmlDataController.AssetsPath+"/"+this.pageString+"/"+SCHtmlDataController.ContentPageFile,t=SCHtmlController.currentWorksapceObj.viewportWidth,i=SCHtmlController.currentWorksapceObj.viewportHeight;this.isPageLeft?this.iframeIdEl="singlePage":this.iframeIdEl="rightPage",$(this.viewContainer).append('<div class="pageContent" style="width:'+this.widthEl+"px; height:"+this.heightEl+'px; z-index: 1; position: absolute"><iframe id="'+this.iframeIdEl+'" frameborder="0" src="'+e+'"style="width:'+t+"px; height:"+i+'px; z-index: 2; position: absolute;"></div>'),this.initResizeWebView(),this.resizeWebView();var n=this;$(this.viewContainer+" .pageContent iframe").load(function(){window.webviewIsShown=!0,SCHtmlController.setIframeId(n.iframeIdEl),n.initSwiper(),SCHtmlController.getSoundtrackWasChecked()||n.checkSoundtrack();var e=SCGeneral.getNavigator().toLowerCase(),t=e.indexOf("webkit")>-1;if(t){var i=$(n.viewContainer+" .pageContent iframe").contents().find("body");i.css("transform-style","preserve-3d")}if($(n.viewContainer+" .loadingImage, .SCLoader").hide(),SCHtmlController.readAloudIsActive&&SCHtmlController.hasReadAloud){var a=SCHtmlController.getPageToSync();SCHtmlController.playAndSyncReadAloud(a)}})},PageViewController.prototype.hideWebViewShowLoadingImage=function(){$(this.viewContainer+" .loadingImage").show(),this.cleanWebView()},PageViewController.prototype.cleanWebView=function(){SCHtmlController.isDoublePageInLandscape?($(this.viewContainer+".leftPageView .pageContent").remove(),$(this.viewContainer+".rightPageView .pageContent").remove()):$(this.viewContainer+".singlePageView .pageContent").remove()},PageViewController.prototype.cleanImageView=function(){},PageViewController.prototype.stopPlayingMultimedia=function(){},PageViewController.prototype.setIsPrevented=function(e){this.isPrevented=e},PageViewController.prototype.getIsPrevented=function(e){return this.isPrevented},PageViewController.prototype.initSwiper=function(){var e=this,t=$("#"+this.iframeIdEl).contents().find("body"),i=SCHtmlController.h.addEventListener,n=document.getElementById(e.iframeIdEl),a=n.contentDocument||n.contentWindow.document;t.bind(SCGeneral.touchDownEvent,function(i){var n=$(i.target),a=$("#"+e.iframeIdEl)[0].contentWindow.$,o=a._data($($("#"+e.iframeIdEl).contents().find(n))[0],"events");if(void 0==o){var r=!1;$("#"+e.iframeIdEl).contents().find(n).parents().each(function(){var t=a._data($(this)[0],"events");void 0!=t&&(r=!0),e.setIsPrevented(!0)}),r||(SCHtmlController.setIsTouchedInIframe(!0),SCHtmlController.onTouchDownForSwiper(i,t))}}),SCHtmlController.currentWorksapceObj.enableSwipe&&i(a,SCGeneral.touchDownEvent,function(e){SCHtmlController.onTouchUpForSwiper(e,t)}),i(a,SCGeneral.touchMoveEvent,function(e){SCHtmlController.onTouchMoveForSwiper(e,t)}),i(a,SCGeneral.touchUpEvent,function(e){SCHtmlController.onTouchUpForSwiper(e,t)})},PageViewController.prototype.checkSoundtrack=function(){if(SCHtmlController.setSoundtrackWasChecked(!0),SCHtmlController.getSoundtrackIsPlaying()&&SCHtmlController.getSoundtrackIsActive())if(SCHtmlController.getSoundtrackIsPlaying()&&!SCHtmlController.soundtrackExists())SCHtmlController.stopSoundtrack(),SCHtmlController.soundtrackIconSetDisabled();else{var e=SCHtmlController.getSoundtrackDomPath();SCHtmlController.getSoundtrackIsPlaying()&&e!=SCHtmlController.getAbsolutePathFromSoundtrack()&&(SCHtmlController.stopSoundtrack(),SCHtmlController.setSoundtrackDomPath(SCHtmlController.getAbsolutePathFromSoundtrack()),$("#"+SCHtmlController.soundtrackDomElName).attr("src",SCHtmlController.getSoundtrackDomPath()),SCHtmlController.startSoundtrack())}else if(!SCHtmlController.getSoundtrackIsPlaying()&&SCHtmlController.getSoundtrackIsActive())SCHtmlController.soundtrackExists()&&(SCHtmlController.soundtrackIconSetEnabled(),SCHtmlController.setSoundtrackDomPath(SCHtmlController.getAbsolutePathFromSoundtrack()),$("#"+SCHtmlController.soundtrackDomElName).attr("src",SCHtmlController.getSoundtrackDomPath()),SCHtmlController.startSoundtrack());else if(0==$("#"+SCHtmlController.soundtrackDomElName).length&&SCHtmlController.soundtrackExists()){var t=SCHtmlController.getAbsolutePathFromSoundtrack(),i='<audio id="'+SCHtmlController.soundtrackDomElName+'" loop><source src="'+t+'"></audio>';SCHtmlController.setSoundtrackDomPath(t),SCHtmlController.setDomEl("#"+SCHtmlController.generalContainerEl,i),SCHtmlController.soundtrackIconSetEnabled(),SCHtmlDataController.isMobileBrowser||(SCHtmlController.startSoundtrack(),SCHtmlController.soundtrackIconSetActive())}else $("#"+SCHtmlController.soundtrackDomElName).length>0&&SCHtmlController.soundtrackExists()?SCHtmlController.soundtrackIconSetEnabled():SCHtmlController.soundtrackIconSetDisabled()},function(e){$("#content").append('<img id="placeholder" src="assets/'+e+'/loading.jpg" />')};